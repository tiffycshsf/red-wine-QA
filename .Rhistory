if (!require("pacman")) install.packages("pacman")
pacman::p_load(tidyverse, skimr, GGally, caret,
randomForest, rpart, corrplot, rpart.plot,
corrgram, ggplot2, readr, corrgram,
visTree, rattle)
wine_data = read.table("C:/Users/tiffy/Desktop/FinalProject/winequality-red-1.csv",header = TRUE,sep = ",")
kable(skim(wine_data))
ggplot(wine_data, aes(x=quality, fill = quality)) +
geom_bar(stat="count") +
geom_text(position = "stack", stat='count',aes(label=..count..), vjust = -0.5)+
labs(y="Num of Observations", x="Wine Quality") +
theme(legend.position="none")
#quality的中位數及第三分位數相同
#查看實際數量
wine_factor = wine_data
wine_factor$quality = as.factor(wine_factor$quality)
ggpairs(wine_factor, aes(colour = quality, alpha = 0.4))
wine_data.cor = cor(wine_data)
corplot = corrplot(wine_data.cor)
corrplot.mixed(cor(wine_data), upper = "ellipse", tl.cex=.8, tl.pos = 'lt', number.cex = .8)
#依quality畫圖
#畫相關係數矩陣圖
#alcohol為正相關,volatie.acidity為負相關
#residual_sugar, free_sulfur_dioxide, and chlorides[弱]
#volatile_acidity, sulphates, and alcohol[強]
wine_data$good_wine = as.factor(ifelse(wine_data$quality>5.5,"1","0"))
set.seed(1)
inTrain = createDataPartition(wine_data$quality, p=.7, list = FALSE)
train = wine_data[inTrain,]
valid = wine_data[-inTrain,]
rm(inTrain)
rpart2 = rpart(good_wine ~ alcohol+volatile_acidity, train)
visTree(rpart2)
fancyRpartPlot(rpart2)
result_rpart2 = predict(rpart2, newdata = valid, type = "class")
confusionMatrix(result_rpart2, valid$good_wine)
rpart3 = rpart(good_wine ~ alcohol+volatile_acidity+citric_acid, train)
visTree(rpart3)
fancyRpartPlot(rpart3)
result_rpart3 = predict(rpart3, newdata = valid, type = "class")
confusionMatrix(result_rpart3, valid$good_wine)
rpart4 = rpart(good_wine ~ alcohol+volatile_acidity+sulphates+citric_acid, train)
visTree(rpart4)
fancyRpartPlot(rpart4)
result_rpart4 = predict(rpart4, newdata = valid, type = "class")
confusionMatrix(result_rpart4, valid$good_wine)
rpart5 = rpart(good_wine ~ alcohol+volatile_acidity+sulphates+citric_acid+density, train)
visTree(rpart5)
fancyRpartPlot(rpart5)
result_rpart5 = predict(rpart5, newdata = valid, type = "class")
confusionMatrix(result_rpart5, valid$good_wine)
inTrain = createDataPartition(wine_data$quality, p=.75, list = FALSE)
train = wine_data[inTrain,]
valid = wine_data[-inTrain,]
rm(inTrain)
rpart2 = rpart(good_wine ~ alcohol+volatile_acidity, train)
visTree(rpart2)
fancyRpartPlot(rpart2)
result_rpart2 = predict(rpart2, newdata = valid, type = "class")
confusionMatrix(result_rpart2, valid$good_wine)
rpart3 = rpart(good_wine ~ alcohol+volatile_acidity+citric_acid, train)
visTree(rpart3)
fancyRpartPlot(rpart3)
result_rpart3 = predict(rpart3, newdata = valid, type = "class")
confusionMatrix(result_rpart3, valid$good_wine)
rpart4 = rpart(good_wine ~ alcohol+volatile_acidity+sulphates+citric_acid, train)
visTree(rpart4)
fancyRpartPlot(rpart4)
result_rpart4 = predict(rpart4, newdata = valid, type = "class")
confusionMatrix(result_rpart4, valid$good_wine)
rpart5 = rpart(good_wine ~ alcohol+volatile_acidity+sulphates+citric_acid+density, train)
visTree(rpart5)
fancyRpartPlot(rpart5)
result_rpart5 = predict(rpart5, newdata = valid, type = "class")
confusionMatrix(result_rpart5, valid$good_wine)
rpart6 = rpart(good_wine ~ alcohol+volatile_acidity+sulphates+citric_acid+density+pH, train)
visTree(rpart6)
fancyRpartPlot(rpart6)
result_rpart6 = predict(rpart6, newdata = valid, type = "class")
confusionMatrix(result_rpart6, valid$good_wine)
set.seed(1)
inTrain = createDataPartition(wine_data$quality, p=.5, list = FALSE)
train = wine_data[inTrain,]
valid = wine_data[-inTrain,]
rm(inTrain)
wine_data = read.table("C:/Users/tiffy/Desktop/FinalProject/winequality-red-1.csv",header = TRUE,sep = ",")
kable(skim(wine_data))
wine_factor = wine_data
wine_factor$quality = as.factor(wine_factor$quality)
wine_data$good_wine = as.factor(ifelse(wine_data$quality>5.5,"1","0"))
set.seed(1)
inTrain = createDataPartition(wine_data$quality, p=.5, list = FALSE)
train = wine_data[inTrain,]
valid = wine_data[-inTrain,]
rm(inTrain)
rpart2 = rpart(good_wine ~ alcohol+volatile_acidity, train)
visTree(rpart2)
fancyRpartPlot(rpart2)
result_rpart2 = predict(rpart2, newdata = valid, type = "class")
confusionMatrix(result_rpart2, valid$good_wine)
rpart3 = rpart(good_wine ~ alcohol+volatile_acidity+citric_acid, train)
visTree(rpart3)
fancyRpartPlot(rpart3)
result_rpart3 = predict(rpart3, newdata = valid, type = "class")
confusionMatrix(result_rpart3, valid$good_wine)
rpart4 = rpart(good_wine ~ alcohol+volatile_acidity+sulphates+citric_acid, train)
visTree(rpart4)
fancyRpartPlot(rpart4)
result_rpart4 = predict(rpart4, newdata = valid, type = "class")
confusionMatrix(result_rpart4, valid$good_wine)
rpart5 = rpart(good_wine ~ alcohol+volatile_acidity+sulphates+citric_acid+density, train)
visTree(rpart5)
fancyRpartPlot(rpart5)
result_rpart5 = predict(rpart5, newdata = valid, type = "class")
confusionMatrix(result_rpart5, valid$good_wine)
rpart6 = rpart(good_wine ~ alcohol+volatile_acidity+sulphates+citric_acid+density+pH, train)
visTree(rpart6)
fancyRpartPlot(rpart6)
result_rpart6 = predict(rpart6, newdata = valid, type = "class")
confusionMatrix(result_rpart6, valid$good_wine)
if (!require("pacman")) install.packages("pacman")
pacman::p_load(tidyverse, skimr, GGally, caret,
randomForest, rpart, corrplot, rpart.plot,
corrgram, ggplot2, readr, corrgram,
visTree, rattle)
wine_data = read.table("C:/Users/tiffy/Desktop/FinalProject/winequality-red-1.csv",header = TRUE,sep = ",")
wine_factor = wine_data
wine_factor$quality = as.factor(wine_factor$quality)
wine_data.cor = cor(wine_data)
wine_data$good_wine = as.factor(ifelse(wine_data$quality>5.5,"1","0"))
set.seed(1)
inTrain = createDataPartition(wine_data$quality, p=.7, list = FALSE)
train = wine_data[inTrain,]
valid = wine_data[-inTrain,]
rm(inTrain)
set.seed(1)
set.seed(5)
rpart2 = rpart(good_wine ~ alcohol+volatile_acidity, train)
visTree(rpart2)
fancyRpartPlot(rpart2)
result_rpart2 = predict(rpart2, newdata = valid, type = "class")
confusionMatrix(result_rpart2, valid$good_wine)
randomF = randomForest(good_wine ~ alcohol+volatile_acidity+citric_acid+density+pH+sulphates,train)
result_randomF = predict(randomF, newdata = valid)
confusionMatrix(result_randomF, valid$good_wine)
rpart6_varimp = varImp(rpart6)
rpart6 = rpart(good_wine ~ alcohol+volatile_acidity+sulphates+citric_acid+density+pH, train)
visTree(rpart6)
fancyRpartPlot(rpart6)
result_rpart6 = predict(rpart6, newdata = valid, type = "class")
confusionMatrix(result_rpart6, valid$good_wine)
rpart6_varimp = varImp(rpart6)
kable(rpart6_varimp)
rpart4 = rpart(good_wine ~ alcohol+volatile_acidity+sulphates+citric_acid, train)
visTree(rpart4)
fancyRpartPlot(rpart4)
result_rpart4 = predict(rpart4, newdata = valid, type = "class")
confusionMatrix(result_rpart4, valid$good_wine)
rpart4_varimp = varImp(rpart4)
kable(rpart4_varimp)
randomF = randomForest(good_wine ~ alcohol+volatile_acidity+citric_acid+density+pH+sulphates,train,ntree = 1000)
result_randomF = predict(randomF, newdata = valid)
confusionMatrix(result_randomF, valid$good_wine)
randomF = randomForest(good_wine ~ alcohol+volatile_acidity+citric_acid+density+pH+sulphates,train,ntree = 100)
result_randomF = predict(randomF, newdata = valid)
confusionMatrix(result_randomF, valid$good_wine)
randomF = randomForest(good_wine ~ alcohol+volatile_acidity+citric_acid+density+pH+sulphates,train,ntree = 300)
result_randomF = predict(randomF, newdata = valid)
confusionMatrix(result_randomF, valid$good_wine)
randomF_imp = varImp(randomF,scale = TRUE)
kable(randomF_imp)
imp_1 = randomF_imp
imp_1$group = rownames(imp_1)
ggplot(imp_1, aes(x=reorder(group,Overall),y=Overall),size=2) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(vjust=1,angle=90))+
labs(x="Variable",y="Overall Importance",title="Scaled Feature Importance")
randomF1 = randomForest(good_wine ~ alcohol+volatile_acidity+citric_acid+density+pH+sulphates+total_sulfur_dioxide+fixed_acidity,train)
result_randomF1 = predict(randomF1, newdata = valid)
confusionMatrix(result_randomF1, valid$good_wine)
randomF_imp1 = varImp(randomF1,scale = TRUE)
kable(randomF_imp1)
imp_2 = randomF_imp1
imp_2$group = rownames(imp_2)
ggplot(imp_2, aes(x=reorder(group,Overall),y=Overall),size=2) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(vjust=1,angle=90))+
labs(x="Variable",y="Overall Importance",title="Scaled Feature Importance")
source('C:/Users/tiffy/Desktop/FinalProject/test1.R', encoding = 'UTF-8')
